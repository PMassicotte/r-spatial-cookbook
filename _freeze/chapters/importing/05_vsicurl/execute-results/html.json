{
  "hash": "025dc5325a9d7389fa6eb7704bbd8185",
  "result": {
    "engine": "knitr",
    "markdown": "# GDAL Virtual File Systems\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(terra)\n```\n:::\n\n\n\n\n\n## Reading the data from a GeoTIFF file\n\n- `vsicurl`: https://gdal.org/drivers/raster/vsicurl.html is a GDAL virtual file system that allows reading files from a URL.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr <- terra::rast(\n  \"/vsicurl/https://gebco2023.s3.valeria.science/gebco_2023_sub_ice_topo_cog.tif\"\n)\n\nr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 43200, 86400, 1  (nrow, ncol, nlyr)\nresolution  : 0.004166667, 0.004166667  (x, y)\nextent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : gebco_2023_sub_ice_topo_cog.tif \nname        : gebco_2023_sub_ice_topo_cog \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(r)\n```\n\n::: {.cell-output-display}\n![](05_vsicurl_files/figure-html/vsicurl-1.png)\n:::\n:::\n\n\n\n\n\n## vsigzip\n\n- `vsigzip`: https://gdal.org/drivers/raster/vsigzip.html is a GDAL virtual file system that allows reading files from a gzip compressed file.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsic <- rast(\n  \"/vsigzip//vsicurl/ftp://ftp-projects.cen.uni-hamburg.de/seaice/AMSR2/3.125km/Arc_20201010_res3.125_pyres.nc.gz\",\n  \"sea_ice_concentration\"\n)\n\nsic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 3584, 2432, 1  (nrow, ncol, nlyr)\nresolution  : 1, 1  (x, y)\nextent      : 0.5, 2432.5, 0.5, 3584.5  (xmin, xmax, ymin, ymax)\ncoord. ref. : +proj=longlat +datum=WGS84 +no_defs \nsource      : Arc_20201010_res3.125_pyres.nc.gz:sea_ice_concentration \nvarname     : sea_ice_concentration (daily averaged total ice concentration) \nname        : sea_ice_concentration \nunit        :                     % \ntime        : 2020-10-10 12:00:00 UTC \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(sic)\n```\n\n::: {.cell-output-display}\n![](05_vsicurl_files/figure-html/vsigzip-1.png)\n:::\n:::\n\n\n\n\n\nFrom the documentation, we expect that data to be in [polar stereographic projection with a specific extent](https://nsidc.org/data/user-resources/help-center/guide-nsidcs-polar-stereographic-projection). However, the data does not have the correct extent and projection. We can set the extent and projection manually:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set the extent\next(sic) <- ext(-3850000L, 3750000L, -5350000L, 5850000L)\n\n# Set the polar stereographic projection\ncrs(sic) <- \"EPSG:3413\"\n\nsic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 3584, 2432, 1  (nrow, ncol, nlyr)\nresolution  : 3125, 3125  (x, y)\nextent      : -3850000, 3750000, -5350000, 5850000  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / NSIDC Sea Ice Polar Stereographic North (EPSG:3413) \nsource      : Arc_20201010_res3.125_pyres.nc.gz:sea_ice_concentration \nvarname     : sea_ice_concentration (daily averaged total ice concentration) \nname        : sea_ice_concentration \nunit        :                     % \ntime        : 2020-10-10 12:00:00 UTC \n```\n\n\n:::\n:::\n\n\n\n\n\nNow the data has the correct extent and projection. Each pixel represents the sea ice concentration in a 3.125 km x 3.125 km area.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sic)\n```\n\n::: {.cell-output-display}\n![](05_vsicurl_files/figure-html/unnamed-chunk-5-1.png)\n:::\n:::\n",
    "supporting": [
      "05_vsicurl_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}